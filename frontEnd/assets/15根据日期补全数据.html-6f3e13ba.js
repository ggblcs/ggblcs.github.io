import{_ as n,p as s,q as a,a1 as t}from"./framework-96b046e1.js";const p={},e=t(`<h1 id="_15-根据日期补全数据" tabindex="-1"><a class="header-anchor" href="#_15-根据日期补全数据" aria-hidden="true">#</a> 15 根据日期补全数据</h1><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> oldData <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">data_date</span><span class="token operator">:</span> <span class="token string">&#39;2023-08-01 00:00:00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data_num</span><span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">data_date</span><span class="token operator">:</span> <span class="token string">&#39;2023-09-02 01:00:00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data_num</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">data_date</span><span class="token operator">:</span> <span class="token string">&#39;2023-11-04 09:00:00&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data_num</span><span class="token operator">:</span> <span class="token string">&#39;5&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment">/* 补全一年12个月 */</span>
<span class="token comment">// 补全一年12个月的数据</span>
<span class="token keyword">const</span> zeroDefaultDataBefore <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">data_date</span><span class="token operator">:</span> <span class="token string">&#39;2023-08-04 00:00:00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data_num</span><span class="token operator">:</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> zeroDefaultDataAfter <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">data_date</span><span class="token operator">:</span> <span class="token string">&#39;2023-08-04 00:00:00&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data_num</span><span class="token operator">:</span> <span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> type <span class="token operator">=</span> <span class="token string">&#39;day&#39;</span>

<span class="token comment">// console.log(completeData(oldData, zeroDefaultDataBefore,zeroDefaultDataAfter, &#39;hours&#39;));</span>
<span class="token comment">// console.log(completeData(oldData, zeroDefaultDataBefore,zeroDefaultDataAfter, &#39;day&#39;));</span>
<span class="token comment">// console.log(completeData(oldData, zeroDefaultDataBefore,zeroDefaultDataAfter, &#39;month&#39;));</span>

<span class="token doc-comment comment">/**
 * 
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">oldData</span> 
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">oldDataItemTemplateBefore</span> 
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token string">&#39;day&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;month&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;hours&#39;</span><span class="token punctuation">}</span></span> <span class="token parameter">type</span> 
 */</span>
<span class="token keyword">function</span> <span class="token function">completeData</span><span class="token punctuation">(</span><span class="token parameter">oldData<span class="token punctuation">,</span> oldDataItemTemplateBefore<span class="token punctuation">,</span> oldDataItemTemplateAfter<span class="token punctuation">,</span> type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> onlyHaveDateArray<span class="token punctuation">;</span>
    <span class="token keyword">let</span> needDateArray<span class="token punctuation">;</span>
    <span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        onlyHaveDateArray <span class="token operator">=</span> oldData<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>   <span class="token keyword">return</span> val<span class="token punctuation">.</span>data_date<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\d{4}-\\d{2}-(\\d{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
        needDateArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;01&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;02&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;03&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;04&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;05&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;06&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;07&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;08&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;09&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;11&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;12&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;13&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;14&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;15&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;16&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;17&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;18&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;19&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;20&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;21&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;22&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;23&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;24&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;25&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;26&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;27&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;28&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;29&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;30&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;31&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;32&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>time<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;hours&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        onlyHaveDateArray <span class="token operator">=</span> oldData<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>   <span class="token keyword">return</span> val<span class="token punctuation">.</span>data_date<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\d{4}-\\d{2}-\\d{2} (\\d{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
         needDateArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;00&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;01&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;02&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;03&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;04&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;05&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;06&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;07&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;08&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;09&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;11&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;12&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;13&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;14&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;15&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;16&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;17&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;18&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;19&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;20&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;21&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;22&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;23&#39;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;month&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        needDateArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;02&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;03&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;04&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;05&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;06&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;07&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;08&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;09&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;10&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;11&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;12&#39;</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token comment">// 需要展示数据的月份</span>
        onlyHaveDateArray <span class="token operator">=</span> oldData<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>   <span class="token keyword">return</span> val<span class="token punctuation">.</span>data_date<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\d{4}-(\\d{2})</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;type 只能为 day month hours&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 取出所有的日</span>
    <span class="token keyword">const</span> newData <span class="token operator">=</span> needDateArray<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">dataNeedItem</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> oldDataIndex <span class="token operator">=</span> onlyHaveDateArray<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>dataNeedItem<span class="token punctuation">)</span>
        <span class="token comment">// console.log(onlyHaveDateArray, dataNeedItem, oldDataIndex === -1);</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>oldDataIndex <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            oldData<span class="token punctuation">[</span>oldDataIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>xAxis <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>dataNeedItem<span class="token punctuation">)</span>
            <span class="token keyword">return</span> oldData<span class="token punctuation">[</span>oldDataIndex<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 需要生成该日期的数据</span>
        <span class="token keyword">const</span> option1 <span class="token operator">=</span> type <span class="token operator">===</span> <span class="token string">&#39;day&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>dataNeedItem<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> time<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> option2 <span class="token operator">=</span> type <span class="token operator">===</span> <span class="token string">&#39;month&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>dataNeedItem<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> option3 <span class="token operator">=</span> type <span class="token operator">===</span> <span class="token string">&#39;hours&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>dataNeedItem<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> newDataItem<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>option1 <span class="token operator">||</span> option2 <span class="token operator">||</span> option3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newDataItem <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>oldDataItemTemplateBefore<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            newDataItem <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>oldDataItemTemplateAfter<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        newDataItem<span class="token punctuation">.</span>xAxis <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>dataNeedItem<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;day&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newDataItem<span class="token punctuation">.</span>data_date <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">0000-00-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataNeedItem<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 00:00:00</span><span class="token template-punctuation string">\`</span></span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;hours&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newDataItem<span class="token punctuation">.</span>data_date <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">0000-00-00 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataNeedItem<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:00:00</span><span class="token template-punctuation string">\`</span></span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">&#39;month&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            newDataItem<span class="token punctuation">.</span>data_date <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">0000-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>dataNeedItem<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-00 00:00:00</span><span class="token template-punctuation string">\`</span></span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> newDataItem
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> newData
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),o=[e];function c(l,i){return s(),a("div",null,o)}const k=n(p,[["render",c],["__file","15根据日期补全数据.html.vue"]]);export{k as default};
